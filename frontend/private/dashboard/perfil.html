<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Mi Perfil - Caminando Online</title>
  <link rel="icon" href="/assets/img/caminando-Favicon.png" type="image/png" />
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet"/>
  <link rel="stylesheet" href="/css/styles.css" />
  <link rel="stylesheet" href="/css/components/footer.css" />
  <link rel="stylesheet" href="/private/css/dashboard-styles.css" />
  <!-- Fonts para logo textual -->
  <link href="https://fonts.googleapis.com/css2?family=Anton&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Roboto+Slab:ital@1&display=swap" rel="stylesheet">
</head>

<body class="dashboard-body">
  <!-- Header del dashboard -->
  <header class="dashboard-header">
    <div class="header-container">
      <!-- Logo y navegaci√≥n principal -->
      <div class="header-left">
        <a href="/index.html" class="dashboard-logo-link">
          <img src="/assets/img/caminando-logo.png" alt="Logo Caminando Online" class="dashboard-logo" />
          <div class="dashboard-logo-text">
            <span class="logo-caminando-text">Caminando</span>
            <span class="logo-online-text">.Online</span>
          </div>
        </a>
      </div>

      <!-- Navegaci√≥n del dashboard -->
      <nav class="dashboard-nav">
        <ul class="nav-list">
          <li class="nav-item">
            <a href="/private/dashboard/dashboard.html" class="nav-link">
              <i class="nav-icon">üè†</i>
              <span>Dashboard</span>
            </a>
          </li>
          <li class="nav-item">
            <a href="/index.html" class="nav-link">
              <i class="nav-icon">üîç</i>
              <span>Comparar</span>
            </a>
          </li>
          <li class="nav-item active">
            <a href="/private/dashboard/perfil.html" class="nav-link">
              <i class="nav-icon">üë§</i>
              <span>Perfil</span>
            </a>
          </li>
          <li class="nav-item">
            <a href="/private/dashboard/pagos.html" class="nav-link">
              <i class="nav-icon">üí≥</i>
              <span>Pagos</span>
            </a>
          </li>
          <li class="nav-item">
            <a href="/private/dashboard/supermercados.html" class="nav-link">
              <i class="nav-icon">üõí</i>
              <span>Supermercados</span>
            </a>
          </li>
        </ul>
      </nav>

      <!-- Men√∫ de usuario -->
      <div class="header-right">
        <div class="user-menu">
          <button class="user-menu-btn" id="user-menu-btn">
            <div class="user-avatar">
              <span id="user-initials">CU</span>
            </div>
            <span class="user-name" id="user-name">Cargando...</span>
            <i class="dropdown-arrow">‚ñº</i>
          </button>
          <div class="user-dropdown" id="user-dropdown">
            <div class="dropdown-header">
              <div class="user-info">
                <div class="user-email" id="user-email">usuario@email.com</div>
                <div class="user-status">Cuenta activa</div>
              </div>
            </div>
            <div class="dropdown-divider"></div>
            <a href="/private/dashboard/perfil.html" class="dropdown-item">
              <i class="item-icon">‚öôÔ∏è</i>
              Configuraci√≥n
            </a>
            <a href="#" class="dropdown-item" id="logout-btn">
              <i class="item-icon">üö™</i>
              Cerrar sesi√≥n
            </a>
          </div>
        </div>
      </div>
    </div>
  </header>

  <!-- Contenido principal -->
  <main class="dashboard-main">
    <div class="dashboard-container">
      
      <!-- Encabezado de la p√°gina -->
      <div class="page-header">
        <h1 class="page-title">Mi Perfil</h1>
        <p class="page-subtitle">Gestion√° tu informaci√≥n personal, direcciones y configuraciones</p>
      </div>

      <div class="profile-grid">
        
        <!-- Informaci√≥n Personal -->
        <section class="dashboard-card profile-info-card">
          <div class="card-header">
            <h3 class="card-title">Informaci√≥n Personal</h3>
            <button class="btn btn-outline-primary btn-sm" id="edit-profile-btn">
              <i class="btn-icon">‚úèÔ∏è</i>
              Editar
            </button>
          </div>
          <div class="card-body">
            <form id="profile-form" class="profile-form">
              <div class="row">
                <div class="col-md-6 mb-3">
                  <label for="nombre" class="form-label">Nombre</label>
                  <input type="text" class="form-control profile-input" id="nombre" name="nombre" disabled>
                  <div class="error-message" id="error-nombre"></div>
                </div>
                <div class="col-md-6 mb-3">
                  <label for="apellido" class="form-label">Apellido</label>
                  <input type="text" class="form-control profile-input" id="apellido" name="apellido" disabled>
                  <div class="error-message" id="error-apellido"></div>
                </div>
              </div>
              <div class="row">
                <div class="col-md-6 mb-3">
                  <label for="email" class="form-label">Email</label>
                  <input type="email" class="form-control profile-input" id="email" name="email" disabled readonly>
                  <small class="form-text text-muted">El email no se puede cambiar</small>
                </div>
                <div class="col-md-6 mb-3">
                  <label for="telefono" class="form-label">Tel√©fono</label>
                  <input type="tel" class="form-control profile-input" id="telefono" name="telefono" disabled>
                  <div class="error-message" id="error-telefono"></div>
                </div>
              </div>
              <div class="row">
                <div class="col-md-6 mb-3">
                  <label for="dni" class="form-label">DNI</label>
                  <input type="text" class="form-control profile-input" id="dni" name="dni" disabled readonly>
                  <small class="form-text text-muted">El DNI no se puede cambiar</small>
                </div>
                <div class="col-md-6 mb-3">
                  <label for="fecha-nacimiento" class="form-label">Fecha de Nacimiento</label>
                  <input type="date" class="form-control profile-input" id="fecha-nacimiento" name="fechaNacimiento" disabled>
                </div>
              </div>
              
              <div class="profile-actions" id="profile-actions" style="display: none;">
                <button type="submit" class="btn btn-primary" id="save-profile-btn">
                  <span class="btn-text">Guardar cambios</span>
                  <span class="btn-loading" style="display: none;">
                    <span class="spinner-border spinner-border-sm me-2"></span>
                    Guardando...
                  </span>
                </button>
                <button type="button" class="btn btn-secondary" id="cancel-edit-btn">Cancelar</button>
              </div>
            </form>
          </div>
        </section>

        <!-- Direcciones -->
        <section class="dashboard-card addresses-card">
          <div class="card-header">
            <h3 class="card-title">Direcciones de Entrega</h3>
            <button class="btn btn-outline-primary btn-sm" id="add-address-btn">
              <i class="btn-icon">+</i>
              Agregar
            </button>
          </div>
          <div class="card-body">
            <div class="addresses-list" id="addresses-list">
              <div class="empty-state">
                <div class="empty-icon">üè†</div>
                <div class="empty-text">
                  <div class="empty-title">No hay direcciones guardadas</div>
                  <div class="empty-subtitle">Agreg√° tu primera direcci√≥n para realizar compras</div>
                </div>
                <button class="btn btn-outline-primary btn-sm" id="add-first-address-btn">
                  Agregar direcci√≥n
                </button>
              </div>
            </div>
          </div>
        </section>

        <!-- Seguridad y Configuraciones Grid 2x2 -->
        <div class="security-settings-grid-2x2">
          
          <!-- Seguridad -->
          <section class="dashboard-card security-card">
            <div class="card-header">
              <h3 class="card-title">
                <i class="title-icon">üîí</i>
                Seguridad
              </h3>
            </div>
            <div class="card-body">
              <div class="security-items">
                <div class="security-item">
                  <div class="security-icon">üîë</div>
                  <div class="security-content">
                    <div class="security-info">
                      <div class="security-title">Contrase√±a</div>
                      <div class="security-subtitle">√öltima modificaci√≥n: hace 30 d√≠as</div>
                    </div>
                    <button class="btn btn-outline-primary btn-sm" id="change-password-btn">
                      ‚úèÔ∏è Cambiar
                    </button>
                  </div>
                </div>
                
                <div class="security-item">
                  <div class="security-icon">üì¨</div>
                  <div class="security-content">
                    <div class="security-info">
                      <div class="security-title">Verificaci√≥n de email</div>
                      <div class="security-subtitle" id="email-verification-status">
                        <span class="status-badge status-success">‚úì Verificado</span>
                      </div>
                    </div>
                  </div>
                </div>
                
                <div class="security-item">
                  <div class="security-icon">üì±</div>
                  <div class="security-content">
                    <div class="security-info">
                      <div class="security-title">Autenticaci√≥n de dos factores</div>
                      <div class="security-subtitle">A√±ade una capa extra de seguridad</div>
                    </div>
                    <button class="btn btn-outline-secondary btn-sm" id="enable-2fa-btn">
                      üîí Habilitar
                    </button>
                  </div>
                </div>
                
                <div class="security-item">
                  <div class="security-icon">üìä</div>
                  <div class="security-content">
                    <div class="security-info">
                      <div class="security-title">Actividad de la cuenta</div>
                      <div class="security-subtitle">√öltimo acceso: Hoy a las 14:32</div>
                    </div>
                    <button class="btn btn-outline-info btn-sm" id="view-activity-btn">
                      üëÅÔ∏è Ver historial
                    </button>
                  </div>
                </div>
              </div>
            </div>
          </section>

          <!-- Notificaciones -->
          <section class="dashboard-card settings-card">
            <div class="card-header">
              <h3 class="card-title">
                <i class="title-icon">üîî</i>
                Notificaciones
              </h3>
            </div>
            <div class="card-body">
              <form class="settings-form">
                <div class="settings-group">
                  <div class="settings-grid">
                    <div class="setting-item">
                      <div class="setting-content">
                        <div class="setting-info">
                          <div class="setting-title">Notificaciones por email</div>
                          <div class="setting-subtitle">Recibir actualizaciones y promociones</div>
                        </div>
                        <div class="form-check form-switch">
                          <input class="form-check-input" type="checkbox" id="notifications-email" name="notificaciones.email" checked>
                        </div>
                      </div>
                    </div>
                    
                    <div class="setting-item">
                      <div class="setting-content">
                        <div class="setting-info">
                          <div class="setting-title">Ofertas y descuentos</div>
                          <div class="setting-subtitle">Recibir alertas de ofertas especiales</div>
                        </div>
                        <div class="form-check form-switch">
                          <input class="form-check-input" type="checkbox" id="notifications-offers" name="notificaciones.ofertas" checked>
                        </div>
                      </div>
                    </div>
                    
                    <div class="setting-item">
                      <div class="setting-content">
                        <div class="setting-info">
                          <div class="setting-title">Alertas de precios</div>
                          <div class="setting-subtitle">Notificar cuando bajan los precios de productos favoritos</div>
                        </div>
                        <div class="form-check form-switch">
                          <input class="form-check-input" type="checkbox" id="notifications-price-alerts" name="notificaciones.alertasPrecios">
                        </div>
                      </div>
                    </div>
                    
                    <div class="setting-item">
                      <div class="setting-content">
                        <div class="setting-info">
                          <div class="setting-title">Compras exitosas</div>
                          <div class="setting-subtitle">Confirmar cuando una compra se realiza correctamente</div>
                        </div>
                        <div class="form-check form-switch">
                          <input class="form-check-input" type="checkbox" id="notifications-purchase-success" name="notificaciones.comprasExitosas" checked>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </form>
            </div>
          </section>

          <!-- Privacidad y Datos -->
          <section class="dashboard-card settings-card">
            <div class="card-header">
              <h3 class="card-title">
                <i class="title-icon">üîí</i>
                Privacidad y Datos
              </h3>
            </div>
            <div class="card-body">
              <form class="settings-form">
                <div class="settings-group">
                  <div class="settings-grid">
                    <div class="setting-item">
                      <div class="setting-content">
                        <div class="setting-info">
                          <div class="setting-title">Compartir datos para mejorar el servicio</div>
                          <div class="setting-subtitle">Ayudanos a personalizar tu experiencia</div>
                        </div>
                        <div class="form-check form-switch">
                          <input class="form-check-input" type="checkbox" id="privacy-share-data" name="privacidad.compartirDatos">
                        </div>
                      </div>
                    </div>
                    
                    <div class="setting-item">
                      <div class="setting-content">
                        <div class="setting-info">
                          <div class="setting-title">Marketing personalizado</div>
                          <div class="setting-subtitle">Recibir contenido basado en tus preferencias</div>
                        </div>
                        <div class="form-check form-switch">
                          <input class="form-check-input" type="checkbox" id="privacy-marketing" name="privacidad.recibirMarketing">
                        </div>
                      </div>
                    </div>
                    
                    <div class="setting-item">
                      <div class="setting-content">
                        <div class="setting-info">
                          <div class="setting-title">Historial de navegaci√≥n</div>
                          <div class="setting-subtitle">Guardar historial para mejorar recomendaciones</div>
                        </div>
                        <div class="form-check form-switch">
                          <input class="form-check-input" type="checkbox" id="privacy-browsing-history" name="privacidad.historialNavegacion" checked>
                        </div>
                      </div>
                    </div>
                    
                    <div class="setting-item">
                      <div class="setting-content">
                        <div class="setting-info">
                          <div class="setting-title">An√°lisis de compras</div>
                          <div class="setting-subtitle">Analizar patrones para sugerir mejores ofertas</div>
                        </div>
                        <div class="form-check form-switch">
                          <input class="form-check-input" type="checkbox" id="privacy-purchase-analysis" name="privacidad.analisisCompras">
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </form>
            </div>
          </section>

          <!-- Preferencias de Compra -->
          <section class="dashboard-card settings-card">
            <div class="card-header">
              <h3 class="card-title">
                <i class="title-icon">üéØ</i>
                Preferencias de Compra
              </h3>
            </div>
            <div class="card-body">
              <form class="settings-form">
                <div class="settings-group">
                  <div class="settings-grid">
                    <div class="setting-item">
                      <div class="setting-content">
                        <div class="setting-info">
                          <div class="setting-title">Compra autom√°tica</div>
                          <div class="setting-subtitle">Realizar compras autom√°ticamente cuando hay mejores precios</div>
                        </div>
                        <div class="form-check form-switch">
                          <input class="form-check-input" type="checkbox" id="auto-purchase" name="preferencias.compraAutomatica">
                        </div>
                      </div>
                    </div>
                    
                    <div class="setting-item">
                      <div class="setting-content">
                        <div class="setting-info">
                          <div class="setting-title">Priorizar eco-friendly</div>
                          <div class="setting-subtitle">Dar preferencia a productos sustentables cuando est√©n disponibles</div>
                        </div>
                        <div class="form-check form-switch">
                          <input class="form-check-input" type="checkbox" id="eco-friendly-priority" name="preferencias.ecoFriendly">
                        </div>
                      </div>
                    </div>
                    
                    <div class="setting-item">
                      <div class="setting-content">
                        <div class="setting-info">
                          <div class="setting-title">Recordar carrito</div>
                          <div class="setting-subtitle">Guardar productos en el carrito para futuras compras</div>
                        </div>
                        <div class="form-check form-switch">
                          <input class="form-check-input" type="checkbox" id="remember-cart" name="preferencias.recordarCarrito" checked>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </form>
            </div>
            
            <div class="settings-actions">
              <button type="submit" class="btn btn-primary btn-lg" id="save-settings-btn">
                <span class="btn-text">üíæ Guardar todas las configuraciones</span>
                <span class="btn-loading" style="display: none;">
                  <span class="spinner-border spinner-border-sm me-2"></span>
                  Guardando...
                </span>
              </button>
              <button type="button" class="btn btn-outline-secondary" id="reset-settings-btn">
                üîÑ Restaurar valores predeterminados
              </button>
            </div>
          </section>
          
        </div>

        <!-- Peligro -->
        <section class="dashboard-card danger-zone-card">
          <div class="card-header">
            <h3 class="card-title text-danger">Zona de Peligro</h3>
          </div>
          <div class="card-body">
            <div class="danger-item">
              <div class="danger-info">
                <div class="danger-title">Eliminar cuenta</div>
                <div class="danger-subtitle">Esta acci√≥n no se puede deshacer. Se eliminar√°n todos tus datos.</div>
              </div>
              <button class="btn btn-outline-danger btn-sm" id="delete-account-btn">
                Eliminar cuenta
              </button>
            </div>
          </div>
        </section>

      </div>
    </div>
  </main>

  <!-- El footer se carga din√°micamente mediante footer-manager.js -->

  <!-- Modal para agregar/editar direcci√≥n -->
  <div class="modal fade" id="addressModal" tabindex="-1">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="addressModalTitle">Agregar Direcci√≥n</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
        </div>
        <div class="modal-body">
          <form id="address-form">
            <div class="row">
              <div class="col-md-6 mb-3">
                <label for="address-alias" class="form-label">Alias *</label>
                <input type="text" class="form-control" id="address-alias" name="alias" placeholder="Casa, Trabajo, etc.">
                <div class="error-message" id="error-address-alias"></div>
              </div>
              <div class="col-md-6 mb-3">
                <label for="address-street" class="form-label">Calle *</label>
                <input type="text" class="form-control" id="address-street" name="calle" placeholder="Av. Corrientes">
                <div class="error-message" id="error-address-street"></div>
              </div>
            </div>
            <div class="row">
              <div class="col-md-4 mb-3">
                <label for="address-number" class="form-label">N√∫mero *</label>
                <input type="text" class="form-control" id="address-number" name="numero" placeholder="1234">
                <div class="error-message" id="error-address-number"></div>
              </div>
              <div class="col-md-4 mb-3">
                <label for="address-floor" class="form-label">Piso</label>
                <input type="text" class="form-control" id="address-floor" name="piso" placeholder="5">
              </div>
              <div class="col-md-4 mb-3">
                <label for="address-apartment" class="form-label">Depto</label>
                <input type="text" class="form-control" id="address-apartment" name="departamento" placeholder="A">
              </div>
            </div>
            <div class="row">
              <div class="col-md-4 mb-3">
                <label for="address-postal-code" class="form-label">C√≥digo Postal *</label>
                <input type="text" class="form-control" id="address-postal-code" name="codigoPostal" placeholder="1001">
                <div class="error-message" id="error-address-postal-code"></div>
              </div>
              <div class="col-md-4 mb-3">
                <label for="address-city" class="form-label">Localidad *</label>
                <input type="text" class="form-control" id="address-city" name="localidad" placeholder="CABA">
                <div class="error-message" id="error-address-city"></div>
              </div>
              <div class="col-md-4 mb-3">
                <label for="address-province" class="form-label">Provincia *</label>
                <select class="form-select" id="address-province" name="provincia">
                  <option value="">Seleccionar...</option>
                  <option value="Buenos Aires">Buenos Aires</option>
                  <option value="CABA">CABA</option>
                  <option value="C√≥rdoba">C√≥rdoba</option>
                  <option value="Santa Fe">Santa Fe</option>
                  <option value="Mendoza">Mendoza</option>
                </select>
                <div class="error-message" id="error-address-province"></div>
              </div>
            </div>
            <div class="mb-3">
              <label for="address-instructions" class="form-label">Instrucciones de entrega</label>
              <textarea class="form-control" id="address-instructions" name="instrucciones" rows="2" placeholder="Ej: Tocar timbre del 2do piso"></textarea>
            </div>
            <div class="form-check">
              <input class="form-check-input" type="checkbox" id="address-is-main" name="esPrincipal">
              <label class="form-check-label" for="address-is-main">
                Marcar como direcci√≥n principal
              </label>
            </div>
          </form>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
          <button type="button" class="btn btn-primary" id="save-address-btn">
            <span class="btn-text">Guardar direcci√≥n</span>
            <span class="btn-loading" style="display: none;">
              <span class="spinner-border spinner-border-sm me-2"></span>
              Guardando...
            </span>
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- Scripts -->
  <!-- Footer Manager - DEBE cargarse PRIMERO para insertar el footer din√°micamente -->
  <script src="/js/components/footer-manager.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  <script src="/js/auth/auth-utils.js"></script>
  <script src="/js/maps/address-validator.js"></script>
  <script src="/js/dashboard/perfil-completo.js"></script>
  
  <!-- Inicializar validador de direcciones -->
  <script>
    document.addEventListener('DOMContentLoaded', function() {
      if (window.AddressValidator) {
        window.AddressValidator.inicializar();
        console.log('‚úÖ AddressValidator inicializado en perfil');
      }
    });
  </script>
</body>
</html>